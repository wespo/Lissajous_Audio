/* DDS Test */

//12 bit long sine table
//3/4 scale sine
PROGMEM prog_uint16_t isinTable16[] = {32768,32805,32843,32881,32918,32956,32994,33031,33069,33107,33144,33182,33220,33258,33295,33333,33371,33408,33446,33484,33521,33559,33597,33634,33672,33710,33747,33785,33823,33860,33898,33936,33973,34011,34049,34086,34124,34162,34199,34237,34274,34312,34350,34387,34425,34463,34500,34538,34575,34613,34651,34688,34726,34763,34801,34838,34876,34914,34951,34989,35026,35064,35101,35139,35176,35214,35251,35289,35326,35364,35401,35439,35476,35514,35551,35589,35626,35664,35701,35738,35776,35813,35851,35888,35925,35963,36000,36038,36075,36112,36150,36187,36224,36262,36299,36336,36373,36411,36448,36485,36523,36560,36597,36634,36672,36709,36746,36783,36820,36858,36895,36932,36969,37006,37043,37080,37117,37155,37192,37229,37266,37303,37340,37377,37414,37451,37488,37525,37562,37599,37636,37673,37710,37747,37784,37821,37857,37894,37931,37968,38005,38042,38078,38115,38152,38189,38226,38262,38299,38336,38373,38409,38446,38483,38519,38556,38593,38629,38666,38702,38739,38775,38812,38849,38885,38922,38958,38995,39031,39067,39104,39140,39177,39213,39249,39286,39322,39358,39395,39431,39467,39504,39540,39576,39612,39648,39685,39721,39757,39793,39829,39865,39901,39937,39974,40010,40046,40082,40118,40154,40189,40225,40261,40297,40333,40369,40405,40441,40476,40512,40548,40584,40619,40655,40691,40727,40762,40798,40833,40869,40905,40940,40976,41011,41047,41082,41118,41153,41189,41224,41259,41295,41330,41365,41401,41436,41471,41507,41542,41577,41612,41647,41682,41718,41753,41788,41823,41858,41893,41928,41963,41998,42033,42068,42102,42137,42172,42207,42242,42277,42311,42346,42381,42415,42450,42485,42519,42554,42589,42623,42658,42692,42727,42761,42795,42830,42864,42899,42933,42967,43002,43036,43070,43104,43138,43173,43207,43241,43275,43309,43343,43377,43411,43445,43479,43513,43547,43581,43614,43648,43682,43716,43750,43783,43817,43851,43884,43918,43951,43985,44019,44052,44086,44119,44152,44186,44219,44253,44286,44319,44352,44386,44419,44452,44485,44518,44551,44584,44617,44650,44683,44716,44749,44782,44815,44848,44881,44914,44946,44979,45012,45044,45077,45110,45142,45175,45207,45240,45272,45305,45337,45370,45402,45434,45467,45499,45531,45563,45595,45628,45660,45692,45724,45756,45788,45820,45852,45884,45915,45947,45979,46011,46043,46074,46106,46138,46169,46201,46232,46264,46295,46327,46358,46390,46421,46452,46484,46515,46546,46577,46608,46640,46671,46702,46733,46764,46795,46826,46857,46888,46918,46949,46980,47011,47041,47072,47103,47133,47164,47194,47225,47255,47286,47316,47347,47377,47407,47437,47468,47498,47528,47558,47588,47618,47648,47678,47708,47738,47768,47798,47828,47857,47887,47917,47947,47976,48006,48035,48065,48094,48124,48153,48183,48212,48241,48271,48300,48329,48358,48387,48416,48445,48474,48503,48532,48561,48590,48619,48648,48676,48705,48734,48762,48791,48820,48848,48877,48905,48934,48962,48990,49019,49047,49075,49103,49131,49159,49188,49216,49244,49271,49299,49327,49355,49383,49411,49438,49466,49494,49521,49549,49576,49604,49631,49659,49686,49713,49741,49768,49795,49822,49849,49876,49904,49931,49957,49984,50011,50038,50065,50092,50118,50145,50172,50198,50225,50251,50278,50304,50331,50357,50383,50410,50436,50462,50488,50514,50540,50566,50592,50618,50644,50670,50696,50722,50747,50773,50799,50824,50850,50875,50901,50926,50951,50977,51002,51027,51053,51078,51103,51128,51153,51178,51203,51228,51253,51278,51302,51327,51352,51376,51401,51426,51450,51475,51499,51523,51548,51572,51596,51620,51645,51669,51693,51717,51741,51765,51789,51812,51836,51860,51884,51907,51931,51955,51978,52002,52025,52048,52072,52095,52118,52142,52165,52188,52211,52234,52257,52280,52303,52326,52348,52371,52394,52417,52439,52462,52484,52507,52529,52552,52574,52596,52619,52641,52663,52685,52707,52729,52751,52773,52795,52817,52838,52860,52882,52903,52925,52947,52968,52990,53011,53032,53054,53075,53096,53117,53138,53159,53180,53201,53222,53243,53264,53285,53306,53326,53347,53367,53388,53408,53429,53449,53470,53490,53510,53530,53550,53571,53591,53611,53631,53650,53670,53690,53710,53730,53749,53769,53788,53808,53827,53847,53866,53885,53905,53924,53943,53962,53981,54000,54019,54038,54057,54076,54094,54113,54132,54150,54169,54187,54206,54224,54243,54261,54279,54297,54316,54334,54352,54370,54388,54406,54423,54441,54459,54477,54494,54512,54529,54547,54564,54582,54599,54616,54634,54651,54668,54685,54702,54719,54736,54753,54770,54786,54803,54820,54836,54853,54869,54886,54902,54919,54935,54951,54967,54984,55000,55016,55032,55048,55064,55079,55095,55111,55127,55142,55158,55173,55189,55204,55219,55235,55250,55265,55280,55295,55310,55325,55340,55355,55370,55385,55400,55414,55429,55443,55458,55472,55487,55501,55515,55530,55544,55558,55572,55586,55600,55614,55628,55642,55655,55669,55683,55696,55710,55723,55737,55750,55764,55777,55790,55803,55816,55829,55842,55855,55868,55881,55894,55907,55919,55932,55944,55957,55969,55982,55994,56006,56019,56031,56043,56055,56067,56079,56091,56103,56115,56126,56138,56150,56161,56173,56184,56196,56207,56218,56229,56241,56252,56263,56274,56285,56296,56307,56317,56328,56339,56350,56360,56371,56381,56392,56402,56412,56422,56433,56443,56453,56463,56473,56483,56493,56502,56512,56522,56532,56541,56551,56560,56570,56579,56588,56597,56607,56616,56625,56634,56643,56652,56661,56669,56678,56687,56695,56704,56712,56721,56729,56738,56746,56754,56762,56771,56779,56787,56795,56802,56810,56818,56826,56833,56841,56849,56856,56864,56871,56878,56886,56893,56900,56907,56914,56921,56928,56935,56942,56948,56955,56962,56968,56975,56981,56988,56994,57000,57007,57013,57019,57025,57031,57037,57043,57049,57055,57060,57066,57072,57077,57083,57088,57093,57099,57104,57109,57114,57120,57125,57130,57135,57139,57144,57149,57154,57158,57163,57167,57172,57176,57181,57185,57189,57193,57198,57202,57206,57210,57213,57217,57221,57225,57228,57232,57236,57239,57243,57246,57249,57253,57256,57259,57262,57265,57268,57271,57274,57277,57279,57282,57285,57287,57290,57292,57295,57297,57299,57301,57304,57306,57308,57310,57312,57314,57315,57317,57319,57320,57322,57324,57325,57326,57328,57329,57330,57332,57333,57334,57335,57336,57337,57337,57338,57339,57340,57340,57341,57341,57342,57342,57342,57343,57343,57343,57343,57343,57343,57343,57343,57343,57342,57342,57342,57341,57341,57340,57340,57339,57338,57337,57337,57336,57335,57334,57333,57332,57330,57329,57328,57326,57325,57324,57322,57320,57319,57317,57315,57314,57312,57310,57308,57306,57304,57301,57299,57297,57295,57292,57290,57287,57285,57282,57279,57277,57274,57271,57268,57265,57262,57259,57256,57253,57249,57246,57243,57239,57236,57232,57228,57225,57221,57217,57213,57210,57206,57202,57198,57193,57189,57185,57181,57176,57172,57167,57163,57158,57154,57149,57144,57139,57135,57130,57125,57120,57114,57109,57104,57099,57093,57088,57083,57077,57072,57066,57060,57055,57049,57043,57037,57031,57025,57019,57013,57007,57000,56994,56988,56981,56975,56968,56962,56955,56948,56942,56935,56928,56921,56914,56907,56900,56893,56886,56878,56871,56864,56856,56849,56841,56833,56826,56818,56810,56802,56795,56787,56779,56771,56762,56754,56746,56738,56729,56721,56712,56704,56695,56687,56678,56669,56661,56652,56643,56634,56625,56616,56607,56597,56588,56579,56570,56560,56551,56541,56532,56522,56512,56502,56493,56483,56473,56463,56453,56443,56433,56422,56412,56402,56392,56381,56371,56360,56350,56339,56328,56317,56307,56296,56285,56274,56263,56252,56241,56229,56218,56207,56196,56184,56173,56161,56150,56138,56126,56115,56103,56091,56079,56067,56055,56043,56031,56019,56006,55994,55982,55969,55957,55944,55932,55919,55907,55894,55881,55868,55855,55842,55829,55816,55803,55790,55777,55764,55750,55737,55723,55710,55696,55683,55669,55655,55642,55628,55614,55600,55586,55572,55558,55544,55530,55515,55501,55487,55472,55458,55443,55429,55414,55400,55385,55370,55355,55340,55325,55310,55295,55280,55265,55250,55235,55219,55204,55189,55173,55158,55142,55127,55111,55095,55079,55064,55048,55032,55016,55000,54984,54967,54951,54935,54919,54902,54886,54869,54853,54836,54820,54803,54786,54770,54753,54736,54719,54702,54685,54668,54651,54634,54616,54599,54582,54564,54547,54529,54512,54494,54477,54459,54441,54423,54406,54388,54370,54352,54334,54316,54297,54279,54261,54243,54224,54206,54187,54169,54150,54132,54113,54094,54076,54057,54038,54019,54000,53981,53962,53943,53924,53905,53885,53866,53847,53827,53808,53788,53769,53749,53730,53710,53690,53670,53650,53631,53611,53591,53571,53550,53530,53510,53490,53470,53449,53429,53408,53388,53367,53347,53326,53306,53285,53264,53243,53222,53201,53180,53159,53138,53117,53096,53075,53054,53032,53011,52990,52968,52947,52925,52903,52882,52860,52838,52817,52795,52773,52751,52729,52707,52685,52663,52641,52619,52596,52574,52552,52529,52507,52484,52462,52439,52417,52394,52371,52348,52326,52303,52280,52257,52234,52211,52188,52165,52142,52118,52095,52072,52048,52025,52002,51978,51955,51931,51907,51884,51860,51836,51812,51789,51765,51741,51717,51693,51669,51645,51620,51596,51572,51548,51523,51499,51475,51450,51426,51401,51376,51352,51327,51302,51278,51253,51228,51203,51178,51153,51128,51103,51078,51053,51027,51002,50977,50951,50926,50901,50875,50850,50824,50799,50773,50747,50722,50696,50670,50644,50618,50592,50566,50540,50514,50488,50462,50436,50410,50383,50357,50331,50304,50278,50251,50225,50198,50172,50145,50118,50092,50065,50038,50011,49984,49957,49931,49904,49876,49849,49822,49795,49768,49741,49713,49686,49659,49631,49604,49576,49549,49521,49494,49466,49438,49411,49383,49355,49327,49299,49271,49244,49216,49188,49159,49131,49103,49075,49047,49019,48990,48962,48934,48905,48877,48848,48820,48791,48762,48734,48705,48676,48648,48619,48590,48561,48532,48503,48474,48445,48416,48387,48358,48329,48300,48271,48241,48212,48183,48153,48124,48094,48065,48035,48006,47976,47947,47917,47887,47857,47828,47798,47768,47738,47708,47678,47648,47618,47588,47558,47528,47498,47468,47437,47407,47377,47347,47316,47286,47255,47225,47194,47164,47133,47103,47072,47041,47011,46980,46949,46918,46888,46857,46826,46795,46764,46733,46702,46671,46640,46608,46577,46546,46515,46484,46452,46421,46390,46358,46327,46295,46264,46232,46201,46169,46138,46106,46074,46043,46011,45979,45947,45915,45884,45852,45820,45788,45756,45724,45692,45660,45628,45595,45563,45531,45499,45467,45434,45402,45370,45337,45305,45272,45240,45207,45175,45142,45110,45077,45044,45012,44979,44946,44914,44881,44848,44815,44782,44749,44716,44683,44650,44617,44584,44551,44518,44485,44452,44419,44386,44352,44319,44286,44253,44219,44186,44152,44119,44086,44052,44019,43985,43951,43918,43884,43851,43817,43783,43750,43716,43682,43648,43614,43581,43547,43513,43479,43445,43411,43377,43343,43309,43275,43241,43207,43173,43138,43104,43070,43036,43002,42967,42933,42899,42864,42830,42795,42761,42727,42692,42658,42623,42589,42554,42519,42485,42450,42415,42381,42346,42311,42277,42242,42207,42172,42137,42102,42068,42033,41998,41963,41928,41893,41858,41823,41788,41753,41718,41682,41647,41612,41577,41542,41507,41471,41436,41401,41365,41330,41295,41259,41224,41189,41153,41118,41082,41047,41011,40976,40940,40905,40869,40833,40798,40762,40727,40691,40655,40619,40584,40548,40512,40476,40441,40405,40369,40333,40297,40261,40225,40189,40154,40118,40082,40046,40010,39974,39937,39901,39865,39829,39793,39757,39721,39685,39648,39612,39576,39540,39504,39467,39431,39395,39358,39322,39286,39249,39213,39177,39140,39104,39067,39031,38995,38958,38922,38885,38849,38812,38775,38739,38702,38666,38629,38593,38556,38519,38483,38446,38409,38373,38336,38299,38262,38226,38189,38152,38115,38078,38042,38005,37968,37931,37894,37857,37821,37784,37747,37710,37673,37636,37599,37562,37525,37488,37451,37414,37377,37340,37303,37266,37229,37192,37155,37117,37080,37043,37006,36969,36932,36895,36858,36820,36783,36746,36709,36672,36634,36597,36560,36523,36485,36448,36411,36373,36336,36299,36262,36224,36187,36150,36112,36075,36038,36000,35963,35925,35888,35851,35813,35776,35738,35701,35664,35626,35589,35551,35514,35476,35439,35401,35364,35326,35289,35251,35214,35176,35139,35101,35064,35026,34989,34951,34914,34876,34838,34801,34763,34726,34688,34651,34613,34575,34538,34500,34463,34425,34387,34350,34312,34274,34237,34199,34162,34124,34086,34049,34011,33973,33936,33898,33860,33823,33785,33747,33710,33672,33634,33597,33559,33521,33484,33446,33408,33371,33333,33295,33258,33220,33182,33144,33107,33069,33031,32994,32956,32918,32881,32843,32805,32768,32730,32692,32654,32617,32579,32541,32504,32466,32428,32391,32353,32315,32277,32240,32202,32164,32127,32089,32051,32014,31976,31938,31901,31863,31825,31788,31750,31712,31675,31637,31599,31562,31524,31486,31449,31411,31373,31336,31298,31261,31223,31185,31148,31110,31072,31035,30997,30960,30922,30884,30847,30809,30772,30734,30697,30659,30621,30584,30546,30509,30471,30434,30396,30359,30321,30284,30246,30209,30171,30134,30096,30059,30021,29984,29946,29909,29871,29834,29797,29759,29722,29684,29647,29610,29572,29535,29497,29460,29423,29385,29348,29311,29273,29236,29199,29162,29124,29087,29050,29012,28975,28938,28901,28863,28826,28789,28752,28715,28677,28640,28603,28566,28529,28492,28455,28418,28380,28343,28306,28269,28232,28195,28158,28121,28084,28047,28010,27973,27936,27899,27862,27825,27788,27751,27714,27678,27641,27604,27567,27530,27493,27457,27420,27383,27346,27309,27273,27236,27199,27162,27126,27089,27052,27016,26979,26942,26906,26869,26833,26796,26760,26723,26686,26650,26613,26577,26540,26504,26468,26431,26395,26358,26322,26286,26249,26213,26177,26140,26104,26068,26031,25995,25959,25923,25887,25850,25814,25778,25742,25706,25670,25634,25598,25561,25525,25489,25453,25417,25381,25346,25310,25274,25238,25202,25166,25130,25094,25059,25023,24987,24951,24916,24880,24844,24808,24773,24737,24702,24666,24630,24595,24559,24524,24488,24453,24417,24382,24346,24311,24276,24240,24205,24170,24134,24099,24064,24028,23993,23958,23923,23888,23853,23817,23782,23747,23712,23677,23642,23607,23572,23537,23502,23467,23433,23398,23363,23328,23293,23258,23224,23189,23154,23120,23085,23050,23016,22981,22946,22912,22877,22843,22808,22774,22740,22705,22671,22636,22602,22568,22533,22499,22465,22431,22397,22362,22328,22294,22260,22226,22192,22158,22124,22090,22056,22022,21988,21954,21921,21887,21853,21819,21785,21752,21718,21684,21651,21617,21584,21550,21516,21483,21449,21416,21383,21349,21316,21282,21249,21216,21183,21149,21116,21083,21050,21017,20984,20951,20918,20885,20852,20819,20786,20753,20720,20687,20654,20621,20589,20556,20523,20491,20458,20425,20393,20360,20328,20295,20263,20230,20198,20165,20133,20101,20068,20036,20004,19972,19940,19907,19875,19843,19811,19779,19747,19715,19683,19651,19620,19588,19556,19524,19492,19461,19429,19397,19366,19334,19303,19271,19240,19208,19177,19145,19114,19083,19051,19020,18989,18958,18927,18895,18864,18833,18802,18771,18740,18709,18678,18647,18617,18586,18555,18524,18494,18463,18432,18402,18371,18341,18310,18280,18249,18219,18188,18158,18128,18098,18067,18037,18007,17977,17947,17917,17887,17857,17827,17797,17767,17737,17707,17678,17648,17618,17588,17559,17529,17500,17470,17441,17411,17382,17352,17323,17294,17264,17235,17206,17177,17148,17119,17090,17061,17032,17003,16974,16945,16916,16887,16859,16830,16801,16773,16744,16715,16687,16658,16630,16601,16573,16545,16516,16488,16460,16432,16404,16376,16347,16319,16291,16264,16236,16208,16180,16152,16124,16097,16069,16041,16014,15986,15959,15931,15904,15876,15849,15822,15794,15767,15740,15713,15686,15659,15631,15604,15578,15551,15524,15497,15470,15443,15417,15390,15363,15337,15310,15284,15257,15231,15204,15178,15152,15125,15099,15073,15047,15021,14995,14969,14943,14917,14891,14865,14839,14813,14788,14762,14736,14711,14685,14660,14634,14609,14584,14558,14533,14508,14482,14457,14432,14407,14382,14357,14332,14307,14282,14257,14233,14208,14183,14159,14134,14109,14085,14060,14036,14012,13987,13963,13939,13915,13890,13866,13842,13818,13794,13770,13746,13723,13699,13675,13651,13628,13604,13580,13557,13533,13510,13487,13463,13440,13417,13393,13370,13347,13324,13301,13278,13255,13232,13209,13187,13164,13141,13118,13096,13073,13051,13028,13006,12983,12961,12939,12916,12894,12872,12850,12828,12806,12784,12762,12740,12718,12697,12675,12653,12632,12610,12588,12567,12545,12524,12503,12481,12460,12439,12418,12397,12376,12355,12334,12313,12292,12271,12250,12229,12209,12188,12168,12147,12127,12106,12086,12065,12045,12025,12005,11985,11964,11944,11924,11904,11885,11865,11845,11825,11805,11786,11766,11747,11727,11708,11688,11669,11650,11630,11611,11592,11573,11554,11535,11516,11497,11478,11459,11441,11422,11403,11385,11366,11348,11329,11311,11292,11274,11256,11238,11219,11201,11183,11165,11147,11129,11112,11094,11076,11058,11041,11023,11006,10988,10971,10953,10936,10919,10901,10884,10867,10850,10833,10816,10799,10782,10765,10749,10732,10715,10699,10682,10666,10649,10633,10616,10600,10584,10568,10551,10535,10519,10503,10487,10471,10456,10440,10424,10408,10393,10377,10362,10346,10331,10316,10300,10285,10270,10255,10240,10225,10210,10195,10180,10165,10150,10135,10121,10106,10092,10077,10063,10048,10034,10020,10005,9991,9977,9963,9949,9935,9921,9907,9893,9880,9866,9852,9839,9825,9812,9798,9785,9771,9758,9745,9732,9719,9706,9693,9680,9667,9654,9641,9628,9616,9603,9591,9578,9566,9553,9541,9529,9516,9504,9492,9480,9468,9456,9444,9432,9420,9409,9397,9385,9374,9362,9351,9339,9328,9317,9306,9294,9283,9272,9261,9250,9239,9228,9218,9207,9196,9185,9175,9164,9154,9143,9133,9123,9113,9102,9092,9082,9072,9062,9052,9042,9033,9023,9013,9003,8994,8984,8975,8965,8956,8947,8938,8928,8919,8910,8901,8892,8883,8874,8866,8857,8848,8840,8831,8823,8814,8806,8797,8789,8781,8773,8764,8756,8748,8740,8733,8725,8717,8709,8702,8694,8686,8679,8671,8664,8657,8649,8642,8635,8628,8621,8614,8607,8600,8593,8587,8580,8573,8567,8560,8554,8547,8541,8535,8528,8522,8516,8510,8504,8498,8492,8486,8480,8475,8469,8463,8458,8452,8447,8442,8436,8431,8426,8421,8415,8410,8405,8400,8396,8391,8386,8381,8377,8372,8368,8363,8359,8354,8350,8346,8342,8337,8333,8329,8325,8322,8318,8314,8310,8307,8303,8299,8296,8292,8289,8286,8282,8279,8276,8273,8270,8267,8264,8261,8258,8256,8253,8250,8248,8245,8243,8240,8238,8236,8234,8231,8229,8227,8225,8223,8221,8220,8218,8216,8215,8213,8211,8210,8209,8207,8206,8205,8203,8202,8201,8200,8199,8198,8198,8197,8196,8195,8195,8194,8194,8193,8193,8193,8192,8192,8192,8192,8192,8192,8192,8192,8192,8193,8193,8193,8194,8194,8195,8195,8196,8197,8198,8198,8199,8200,8201,8202,8203,8205,8206,8207,8209,8210,8211,8213,8215,8216,8218,8220,8221,8223,8225,8227,8229,8231,8234,8236,8238,8240,8243,8245,8248,8250,8253,8256,8258,8261,8264,8267,8270,8273,8276,8279,8282,8286,8289,8292,8296,8299,8303,8307,8310,8314,8318,8322,8325,8329,8333,8337,8342,8346,8350,8354,8359,8363,8368,8372,8377,8381,8386,8391,8396,8400,8405,8410,8415,8421,8426,8431,8436,8442,8447,8452,8458,8463,8469,8475,8480,8486,8492,8498,8504,8510,8516,8522,8528,8535,8541,8547,8554,8560,8567,8573,8580,8587,8593,8600,8607,8614,8621,8628,8635,8642,8649,8657,8664,8671,8679,8686,8694,8702,8709,8717,8725,8733,8740,8748,8756,8764,8773,8781,8789,8797,8806,8814,8823,8831,8840,8848,8857,8866,8874,8883,8892,8901,8910,8919,8928,8938,8947,8956,8965,8975,8984,8994,9003,9013,9023,9033,9042,9052,9062,9072,9082,9092,9102,9113,9123,9133,9143,9154,9164,9175,9185,9196,9207,9218,9228,9239,9250,9261,9272,9283,9294,9306,9317,9328,9339,9351,9362,9374,9385,9397,9409,9420,9432,9444,9456,9468,9480,9492,9504,9516,9529,9541,9553,9566,9578,9591,9603,9616,9628,9641,9654,9667,9680,9693,9706,9719,9732,9745,9758,9771,9785,9798,9812,9825,9839,9852,9866,9880,9893,9907,9921,9935,9949,9963,9977,9991,10005,10020,10034,10048,10063,10077,10092,10106,10121,10135,10150,10165,10180,10195,10210,10225,10240,10255,10270,10285,10300,10316,10331,10346,10362,10377,10393,10408,10424,10440,10456,10471,10487,10503,10519,10535,10551,10568,10584,10600,10616,10633,10649,10666,10682,10699,10715,10732,10749,10765,10782,10799,10816,10833,10850,10867,10884,10901,10919,10936,10953,10971,10988,11006,11023,11041,11058,11076,11094,11112,11129,11147,11165,11183,11201,11219,11238,11256,11274,11292,11311,11329,11348,11366,11385,11403,11422,11441,11459,11478,11497,11516,11535,11554,11573,11592,11611,11630,11650,11669,11688,11708,11727,11747,11766,11786,11805,11825,11845,11865,11885,11904,11924,11944,11964,11985,12005,12025,12045,12065,12086,12106,12127,12147,12168,12188,12209,12229,12250,12271,12292,12313,12334,12355,12376,12397,12418,12439,12460,12481,12503,12524,12545,12567,12588,12610,12632,12653,12675,12697,12718,12740,12762,12784,12806,12828,12850,12872,12894,12916,12939,12961,12983,13006,13028,13051,13073,13096,13118,13141,13164,13187,13209,13232,13255,13278,13301,13324,13347,13370,13393,13417,13440,13463,13487,13510,13533,13557,13580,13604,13628,13651,13675,13699,13723,13746,13770,13794,13818,13842,13866,13890,13915,13939,13963,13987,14012,14036,14060,14085,14109,14134,14159,14183,14208,14233,14257,14282,14307,14332,14357,14382,14407,14432,14457,14482,14508,14533,14558,14584,14609,14634,14660,14685,14711,14736,14762,14788,14813,14839,14865,14891,14917,14943,14969,14995,15021,15047,15073,15099,15125,15152,15178,15204,15231,15257,15284,15310,15337,15363,15390,15417,15443,15470,15497,15524,15551,15578,15604,15631,15659,15686,15713,15740,15767,15794,15822,15849,15876,15904,15931,15959,15986,16014,16041,16069,16097,16124,16152,16180,16208,16236,16264,16291,16319,16347,16376,16404,16432,16460,16488,16516,16545,16573,16601,16630,16658,16687,16715,16744,16773,16801,16830,16859,16887,16916,16945,16974,17003,17032,17061,17090,17119,17148,17177,17206,17235,17264,17294,17323,17352,17382,17411,17441,17470,17500,17529,17559,17588,17618,17648,17678,17707,17737,17767,17797,17827,17857,17887,17917,17947,17977,18007,18037,18067,18098,18128,18158,18188,18219,18249,18280,18310,18341,18371,18402,18432,18463,18494,18524,18555,18586,18617,18647,18678,18709,18740,18771,18802,18833,18864,18895,18927,18958,18989,19020,19051,19083,19114,19145,19177,19208,19240,19271,19303,19334,19366,19397,19429,19461,19492,19524,19556,19588,19620,19651,19683,19715,19747,19779,19811,19843,19875,19907,19940,19972,20004,20036,20068,20101,20133,20165,20198,20230,20263,20295,20328,20360,20393,20425,20458,20491,20523,20556,20589,20621,20654,20687,20720,20753,20786,20819,20852,20885,20918,20951,20984,21017,21050,21083,21116,21149,21183,21216,21249,21282,21316,21349,21383,21416,21449,21483,21516,21550,21584,21617,21651,21684,21718,21752,21785,21819,21853,21887,21921,21954,21988,22022,22056,22090,22124,22158,22192,22226,22260,22294,22328,22362,22397,22431,22465,22499,22533,22568,22602,22636,22671,22705,22740,22774,22808,22843,22877,22912,22946,22981,23016,23050,23085,23120,23154,23189,23224,23258,23293,23328,23363,23398,23433,23467,23502,23537,23572,23607,23642,23677,23712,23747,23782,23817,23853,23888,23923,23958,23993,24028,24064,24099,24134,24170,24205,24240,24276,24311,24346,24382,24417,24453,24488,24524,24559,24595,24630,24666,24702,24737,24773,24808,24844,24880,24916,24951,24987,25023,25059,25094,25130,25166,25202,25238,25274,25310,25346,25381,25417,25453,25489,25525,25561,25598,25634,25670,25706,25742,25778,25814,25850,25887,25923,25959,25995,26031,26068,26104,26140,26177,26213,26249,26286,26322,26358,26395,26431,26468,26504,26540,26577,26613,26650,26686,26723,26760,26796,26833,26869,26906,26942,26979,27016,27052,27089,27126,27162,27199,27236,27273,27309,27346,27383,27420,27457,27493,27530,27567,27604,27641,27678,27714,27751,27788,27825,27862,27899,27936,27973,28010,28047,28084,28121,28158,28195,28232,28269,28306,28343,28380,28418,28455,28492,28529,28566,28603,28640,28677,28715,28752,28789,28826,28863,28901,28938,28975,29012,29050,29087,29124,29162,29199,29236,29273,29311,29348,29385,29423,29460,29497,29535,29572,29610,29647,29684,29722,29759,29797,29834,29871,29909,29946,29984,30021,30059,30096,30134,30171,30209,30246,30284,30321,30359,30396,30434,30471,30509,30546,30584,30621,30659,30697,30734,30772,30809,30847,30884,30922,30960,30997,31035,31072,31110,31148,31185,31223,31261,31298,31336,31373,31411,31449,31486,31524,31562,31599,31637,31675,31712,31750,31788,31825,31863,31901,31938,31976,32014,32051,32089,32127,32164,32202,32240,32277,32315,32353,32391,32428,32466,32504,32541,32579,32617,32654,32692,32730};
//full scale sine
//PROGMEM prog_uint16_t isinTable16[] = { 32768,32818,32868,32918,32969,33019,33069,33119,33170,33220,33270,33320,33371,33421,33471,33521,33572,33622,33672,33722,33773,33823,33873,33923,33974,34024,34074,34124,34175,34225,34275,34325,34375,34426,34476,34526,34576,34626,34677,34727,34777,34827,34877,34927,34978,35028,35078,35128,35178,35228,35278,35328,35379,35429,35479,35529,35579,35629,35679,35729,35779,35829,35879,35929,35979,36029,36079,36129,36179,36229,36279,36329,36379,36429,36479,36529,36579,36629,36679,36729,36779,36829,36878,36928,36978,37028,37078,37128,37177,37227,37277,37327,37377,37426,37476,37526,37576,37625,37675,37725,37774,37824,37874,37923,37973,38023,38072,38122,38171,38221,38271,38320,38370,38419,38469,38518,38568,38617,38666,38716,38765,38815,38864,38914,38963,39012,39062,39111,39160,39210,39259,39308,39357,39407,39456,39505,39554,39603,39652,39702,39751,39800,39849,39898,39947,39996,40045,40094,40143,40192,40241,40290,40339,40388,40437,40485,40534,40583,40632,40681,40729,40778,40827,40876,40924,40973,41022,41070,41119,41168,41216,41265,41313,41362,41410,41459,41507,41556,41604,41652,41701,41749,41797,41846,41894,41942,41991,42039,42087,42135,42183,42231,42280,42328,42376,42424,42472,42520,42568,42616,42664,42712,42759,42807,42855,42903,42951,42998,43046,43094,43142,43189,43237,43285,43332,43380,43427,43475,43522,43570,43617,43665,43712,43759,43807,43854,43901,43949,43996,44043,44090,44137,44184,44232,44279,44326,44373,44420,44467,44514,44561,44607,44654,44701,44748,44795,44841,44888,44935,44981,45028,45075,45121,45168,45214,45261,45307,45354,45400,45446,45493,45539,45585,45632,45678,45724,45770,45816,45862,45908,45954,46000,46046,46092,46138,46184,46230,46276,46322,46367,46413,46459,46504,46550,46596,46641,46687,46732,46778,46823,46868,46914,46959,47004,47050,47095,47140,47185,47230,47275,47320,47366,47410,47455,47500,47545,47590,47635,47680,47724,47769,47814,47858,47903,47948,47992,48037,48081,48125,48170,48214,48259,48303,48347,48391,48435,48480,48524,48568,48612,48656,48700,48744,48787,48831,48875,48919,48963,49006,49050,49093,49137,49181,49224,49267,49311,49354,49398,49441,49484,49527,49570,49614,49657,49700,49743,49786,49829,49872,49914,49957,50000,50043,50085,50128,50171,50213,50256,50298,50341,50383,50426,50468,50510,50552,50595,50637,50679,50721,50763,50805,50847,50889,50931,50972,51014,51056,51098,51139,51181,51222,51264,51305,51347,51388,51430,51471,51512,51553,51594,51636,51677,51718,51759,51800,51841,51881,51922,51963,52004,52044,52085,52126,52166,52207,52247,52287,52328,52368,52408,52449,52489,52529,52569,52609,52649,52689,52729,52769,52808,52848,52888,52927,52967,53007,53046,53086,53125,53164,53204,53243,53282,53321,53360,53399,53439,53477,53516,53555,53594,53633,53672,53710,53749,53788,53826,53865,53903,53941,53980,54018,54056,54094,54133,54171,54209,54247,54285,54323,54360,54398,54436,54474,54511,54549,54586,54624,54661,54699,54736,54773,54810,54848,54885,54922,54959,54996,55033,55069,55106,55143,55180,55216,55253,55289,55326,55362,55399,55435,55471,55508,55544,55580,55616,55652,55688,55724,55760,55795,55831,55867,55902,55938,55973,56009,56044,56080,56115,56150,56185,56221,56256,56291,56326,56361,56395,56430,56465,56500,56534,56569,56603,56638,56672,56707,56741,56775,56809,56843,56877,56912,56945,56979,57013,57047,57081,57114,57148,57182,57215,57248,57282,57315,57348,57382,57415,57448,57481,57514,57547,57580,57613,57645,57678,57711,57743,57776,57808,57841,57873,57905,57937,57969,58002,58034,58066,58098,58129,58161,58193,58225,58256,58288,58319,58351,58382,58413,58445,58476,58507,58538,58569,58600,58631,58662,58693,58723,58754,58784,58815,58845,58876,58906,58937,58967,58997,59027,59057,59087,59117,59147,59177,59206,59236,59266,59295,59325,59354,59383,59413,59442,59471,59500,59529,59558,59587,59616,59645,59673,59702,59731,59759,59788,59816,59844,59873,59901,59929,59957,59985,60013,60041,60069,60097,60124,60152,60179,60207,60234,60262,60289,60316,60344,60371,60398,60425,60452,60479,60505,60532,60559,60585,60612,60638,60665,60691,60717,60744,60770,60796,60822,60848,60874,60899,60925,60951,60976,61002,61027,61053,61078,61103,61129,61154,61179,61204,61229,61254,61279,61303,61328,61353,61377,61402,61426,61450,61475,61499,61523,61547,61571,61595,61619,61643,61666,61690,61714,61737,61761,61784,61807,61830,61854,61877,61900,61923,61946,61969,61991,62014,62037,62059,62082,62104,62127,62149,62171,62193,62215,62237,62259,62281,62303,62325,62346,62368,62389,62411,62432,62454,62475,62496,62517,62538,62559,62580,62601,62622,62642,62663,62683,62704,62724,62745,62765,62785,62805,62825,62845,62865,62885,62905,62924,62944,62964,62983,63003,63022,63041,63060,63080,63099,63118,63136,63155,63174,63193,63211,63230,63248,63267,63285,63303,63322,63340,63358,63376,63394,63412,63429,63447,63465,63482,63500,63517,63534,63552,63569,63586,63603,63620,63637,63654,63670,63687,63704,63720,63737,63753,63769,63786,63802,63818,63834,63850,63866,63882,63897,63913,63929,63944,63960,63975,63990,64005,64021,64036,64051,64066,64080,64095,64110,64125,64139,64154,64168,64182,64197,64211,64225,64239,64253,64267,64281,64294,64308,64322,64335,64349,64362,64375,64388,64402,64415,64428,64441,64453,64466,64479,64491,64504,64517,64529,64541,64553,64566,64578,64590,64602,64614,64625,64637,64649,64660,64672,64683,64695,64706,64717,64728,64739,64750,64761,64772,64783,64793,64804,64815,64825,64835,64846,64856,64866,64876,64886,64896,64906,64916,64925,64935,64944,64954,64963,64973,64982,64991,65000,65009,65018,65027,65036,65044,65053,65062,65070,65079,65087,65095,65103,65111,65119,65127,65135,65143,65151,65158,65166,65173,65181,65188,65195,65203,65210,65217,65224,65231,65237,65244,65251,65257,65264,65270,65277,65283,65289,65295,65301,65307,65313,65319,65325,65330,65336,65341,65347,65352,65357,65363,65368,65373,65378,65383,65387,65392,65397,65401,65406,65410,65415,65419,65423,65427,65431,65435,65439,65443,65447,65450,65454,65457,65461,65464,65468,65471,65474,65477,65480,65483,65486,65488,65491,65494,65496,65498,65501,65503,65505,65507,65509,65511,65513,65515,65517,65518,65520,65522,65523,65524,65526,65527,65528,65529,65530,65531,65532,65532,65533,65534,65534,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65534,65534,65533,65532,65532,65531,65530,65529,65528,65527,65526,65524,65523,65522,65520,65518,65517,65515,65513,65511,65509,65507,65505,65503,65501,65498,65496,65494,65491,65488,65486,65483,65480,65477,65474,65471,65468,65464,65461,65457,65454,65450,65447,65443,65439,65435,65431,65427,65423,65419,65415,65410,65406,65401,65397,65392,65387,65383,65378,65373,65368,65363,65357,65352,65347,65341,65336,65330,65325,65319,65313,65307,65301,65295,65289,65283,65277,65270,65264,65257,65251,65244,65237,65231,65224,65217,65210,65203,65195,65188,65181,65173,65166,65158,65151,65143,65135,65127,65119,65111,65103,65095,65087,65079,65070,65062,65053,65044,65036,65027,65018,65009,65000,64991,64982,64973,64963,64954,64944,64935,64925,64916,64906,64896,64886,64876,64866,64856,64846,64835,64825,64815,64804,64793,64783,64772,64761,64750,64739,64728,64717,64706,64695,64683,64672,64660,64649,64637,64625,64614,64602,64590,64578,64566,64553,64541,64529,64517,64504,64491,64479,64466,64453,64441,64428,64415,64402,64388,64375,64362,64349,64335,64322,64308,64294,64281,64267,64253,64239,64225,64211,64197,64182,64168,64154,64139,64125,64110,64095,64080,64066,64051,64036,64021,64005,63990,63975,63960,63944,63929,63913,63897,63882,63866,63850,63834,63818,63802,63786,63769,63753,63737,63720,63704,63687,63670,63654,63637,63620,63603,63586,63569,63552,63534,63517,63500,63482,63465,63447,63429,63412,63394,63376,63358,63340,63322,63303,63285,63267,63248,63230,63211,63193,63174,63155,63136,63118,63099,63080,63060,63041,63022,63003,62983,62964,62944,62924,62905,62885,62865,62845,62825,62805,62785,62765,62745,62724,62704,62683,62663,62642,62622,62601,62580,62559,62538,62517,62496,62475,62454,62432,62411,62389,62368,62346,62325,62303,62281,62259,62237,62215,62193,62171,62149,62127,62104,62082,62059,62037,62014,61991,61969,61946,61923,61900,61877,61854,61830,61807,61784,61761,61737,61714,61690,61666,61643,61619,61595,61571,61547,61523,61499,61475,61450,61426,61402,61377,61353,61328,61303,61279,61254,61229,61204,61179,61154,61129,61103,61078,61053,61027,61002,60976,60951,60925,60899,60874,60848,60822,60796,60770,60744,60717,60691,60665,60638,60612,60585,60559,60532,60505,60479,60452,60425,60398,60371,60344,60316,60289,60262,60234,60207,60179,60152,60124,60097,60069,60041,60013,59985,59957,59929,59901,59873,59844,59816,59788,59759,59731,59702,59673,59645,59616,59587,59558,59529,59500,59471,59442,59413,59383,59354,59325,59295,59266,59236,59206,59177,59147,59117,59087,59057,59027,58997,58967,58937,58906,58876,58845,58815,58784,58754,58723,58693,58662,58631,58600,58569,58538,58507,58476,58445,58413,58382,58351,58319,58288,58256,58225,58193,58161,58129,58098,58066,58034,58002,57969,57937,57905,57873,57841,57808,57776,57743,57711,57678,57645,57613,57580,57547,57514,57481,57448,57415,57382,57348,57315,57282,57248,57215,57182,57148,57114,57081,57047,57013,56979,56945,56912,56877,56843,56809,56775,56741,56707,56672,56638,56603,56569,56534,56500,56465,56430,56395,56361,56326,56291,56256,56221,56185,56150,56115,56080,56044,56009,55973,55938,55902,55867,55831,55795,55760,55724,55688,55652,55616,55580,55544,55508,55471,55435,55399,55362,55326,55289,55253,55216,55180,55143,55106,55069,55033,54996,54959,54922,54885,54848,54810,54773,54736,54699,54661,54624,54586,54549,54511,54474,54436,54398,54360,54323,54285,54247,54209,54171,54133,54094,54056,54018,53980,53941,53903,53865,53826,53788,53749,53710,53672,53633,53594,53555,53516,53477,53439,53399,53360,53321,53282,53243,53204,53164,53125,53086,53046,53007,52967,52927,52888,52848,52808,52769,52729,52689,52649,52609,52569,52529,52489,52449,52408,52368,52328,52287,52247,52207,52166,52126,52085,52044,52004,51963,51922,51881,51841,51800,51759,51718,51677,51636,51594,51553,51512,51471,51430,51388,51347,51305,51264,51222,51181,51139,51098,51056,51014,50972,50931,50889,50847,50805,50763,50721,50679,50637,50595,50552,50510,50468,50426,50383,50341,50298,50256,50213,50171,50128,50085,50043,50000,49957,49914,49872,49829,49786,49743,49700,49657,49614,49570,49527,49484,49441,49398,49354,49311,49267,49224,49181,49137,49093,49050,49006,48963,48919,48875,48831,48787,48744,48700,48656,48612,48568,48524,48480,48435,48391,48347,48303,48259,48214,48170,48125,48081,48037,47992,47948,47903,47858,47814,47769,47724,47680,47635,47590,47545,47500,47455,47410,47366,47320,47275,47230,47185,47140,47095,47050,47004,46959,46914,46868,46823,46778,46732,46687,46641,46596,46550,46504,46459,46413,46367,46322,46276,46230,46184,46138,46092,46046,46000,45954,45908,45862,45816,45770,45724,45678,45632,45585,45539,45493,45446,45400,45354,45307,45261,45214,45168,45121,45075,45028,44981,44935,44888,44841,44795,44748,44701,44654,44607,44561,44514,44467,44420,44373,44326,44279,44232,44184,44137,44090,44043,43996,43949,43901,43854,43807,43759,43712,43665,43617,43570,43522,43475,43427,43380,43332,43285,43237,43189,43142,43094,43046,42998,42951,42903,42855,42807,42759,42712,42664,42616,42568,42520,42472,42424,42376,42328,42280,42231,42183,42135,42087,42039,41991,41942,41894,41846,41797,41749,41701,41652,41604,41556,41507,41459,41410,41362,41313,41265,41216,41168,41119,41070,41022,40973,40924,40876,40827,40778,40729,40681,40632,40583,40534,40485,40437,40388,40339,40290,40241,40192,40143,40094,40045,39996,39947,39898,39849,39800,39751,39702,39652,39603,39554,39505,39456,39407,39357,39308,39259,39210,39160,39111,39062,39012,38963,38914,38864,38815,38765,38716,38666,38617,38568,38518,38469,38419,38370,38320,38271,38221,38171,38122,38072,38023,37973,37923,37874,37824,37774,37725,37675,37625,37576,37526,37476,37426,37377,37327,37277,37227,37177,37128,37078,37028,36978,36928,36878,36829,36779,36729,36679,36629,36579,36529,36479,36429,36379,36329,36279,36229,36179,36129,36079,36029,35979,35929,35879,35829,35779,35729,35679,35629,35579,35529,35479,35429,35379,35328,35278,35228,35178,35128,35078,35028,34978,34927,34877,34827,34777,34727,34677,34626,34576,34526,34476,34426,34375,34325,34275,34225,34175,34124,34074,34024,33974,33923,33873,33823,33773,33722,33672,33622,33572,33521,33471,33421,33371,33320,33270,33220,33170,33119,33069,33019,32969,32918,32868,32818,32767,32717,32667,32617,32566,32516,32466,32416,32365,32315,32265,32215,32164,32114,32064,32014,31963,31913,31863,31813,31762,31712,31662,31612,31561,31511,31461,31411,31360,31310,31260,31210,31160,31109,31059,31009,30959,30909,30858,30808,30758,30708,30658,30608,30557,30507,30457,30407,30357,30307,30257,30207,30156,30106,30056,30006,29956,29906,29856,29806,29756,29706,29656,29606,29556,29506,29456,29406,29356,29306,29256,29206,29156,29106,29056,29006,28956,28906,28856,28806,28756,28706,28657,28607,28557,28507,28457,28407,28358,28308,28258,28208,28158,28109,28059,28009,27959,27910,27860,27810,27761,27711,27661,27612,27562,27512,27463,27413,27364,27314,27264,27215,27165,27116,27066,27017,26967,26918,26869,26819,26770,26720,26671,26621,26572,26523,26473,26424,26375,26325,26276,26227,26178,26128,26079,26030,25981,25932,25883,25833,25784,25735,25686,25637,25588,25539,25490,25441,25392,25343,25294,25245,25196,25147,25098,25050,25001,24952,24903,24854,24806,24757,24708,24659,24611,24562,24513,24465,24416,24367,24319,24270,24222,24173,24125,24076,24028,23979,23931,23883,23834,23786,23738,23689,23641,23593,23544,23496,23448,23400,23352,23304,23255,23207,23159,23111,23063,23015,22967,22919,22871,22823,22776,22728,22680,22632,22584,22537,22489,22441,22393,22346,22298,22250,22203,22155,22108,22060,22013,21965,21918,21870,21823,21776,21728,21681,21634,21586,21539,21492,21445,21398,21351,21303,21256,21209,21162,21115,21068,21021,20974,20928,20881,20834,20787,20740,20694,20647,20600,20554,20507,20460,20414,20367,20321,20274,20228,20181,20135,20089,20042,19996,19950,19903,19857,19811,19765,19719,19673,19627,19581,19535,19489,19443,19397,19351,19305,19259,19213,19168,19122,19076,19031,18985,18939,18894,18848,18803,18757,18712,18667,18621,18576,18531,18485,18440,18395,18350,18305,18260,18215,18169,18125,18080,18035,17990,17945,17900,17855,17811,17766,17721,17677,17632,17587,17543,17498,17454,17410,17365,17321,17276,17232,17188,17144,17100,17055,17011,16967,16923,16879,16835,16791,16748,16704,16660,16616,16572,16529,16485,16442,16398,16354,16311,16268,16224,16181,16137,16094,16051,16008,15965,15921,15878,15835,15792,15749,15706,15663,15621,15578,15535,15492,15450,15407,15364,15322,15279,15237,15194,15152,15109,15067,15025,14983,14940,14898,14856,14814,14772,14730,14688,14646,14604,14563,14521,14479,14437,14396,14354,14313,14271,14230,14188,14147,14105,14064,14023,13982,13941,13899,13858,13817,13776,13735,13694,13654,13613,13572,13531,13491,13450,13409,13369,13328,13288,13248,13207,13167,13127,13086,13046,13006,12966,12926,12886,12846,12806,12766,12727,12687,12647,12608,12568,12528,12489,12449,12410,12371,12331,12292,12253,12214,12175,12136,12096,12058,12019,11980,11941,11902,11863,11825,11786,11747,11709,11670,11632,11594,11555,11517,11479,11441,11402,11364,11326,11288,11250,11212,11175,11137,11099,11061,11024,10986,10949,10911,10874,10836,10799,10762,10725,10687,10650,10613,10576,10539,10502,10466,10429,10392,10355,10319,10282,10246,10209,10173,10136,10100,10064,10027,9991,9955,9919,9883,9847,9811,9775,9740,9704,9668,9633,9597,9562,9526,9491,9455,9420,9385,9350,9314,9279,9244,9209,9174,9140,9105,9070,9035,9001,8966,8932,8897,8863,8828,8794,8760,8726,8692,8658,8623,8590,8556,8522,8488,8454,8421,8387,8353,8320,8287,8253,8220,8187,8153,8120,8087,8054,8021,7988,7955,7922,7890,7857,7824,7792,7759,7727,7694,7662,7630,7598,7566,7533,7501,7469,7437,7406,7374,7342,7310,7279,7247,7216,7184,7153,7122,7090,7059,7028,6997,6966,6935,6904,6873,6842,6812,6781,6751,6720,6690,6659,6629,6598,6568,6538,6508,6478,6448,6418,6388,6358,6329,6299,6269,6240,6210,6181,6152,6122,6093,6064,6035,6006,5977,5948,5919,5890,5862,5833,5804,5776,5747,5719,5691,5662,5634,5606,5578,5550,5522,5494,5466,5438,5411,5383,5356,5328,5301,5273,5246,5219,5191,5164,5137,5110,5083,5056,5030,5003,4976,4950,4923,4897,4870,4844,4818,4791,4765,4739,4713,4687,4661,4636,4610,4584,4559,4533,4508,4482,4457,4432,4406,4381,4356,4331,4306,4281,4256,4232,4207,4182,4158,4133,4109,4085,4060,4036,4012,3988,3964,3940,3916,3892,3869,3845,3821,3798,3774,3751,3728,3705,3681,3658,3635,3612,3589,3566,3544,3521,3498,3476,3453,3431,3408,3386,3364,3342,3320,3298,3276,3254,3232,3210,3189,3167,3146,3124,3103,3081,3060,3039,3018,2997,2976,2955,2934,2913,2893,2872,2852,2831,2811,2790,2770,2750,2730,2710,2690,2670,2650,2630,2611,2591,2571,2552,2532,2513,2494,2475,2455,2436,2417,2399,2380,2361,2342,2324,2305,2287,2268,2250,2232,2213,2195,2177,2159,2141,2123,2106,2088,2070,2053,2035,2018,2001,1983,1966,1949,1932,1915,1898,1881,1865,1848,1831,1815,1798,1782,1766,1749,1733,1717,1701,1685,1669,1653,1638,1622,1606,1591,1575,1560,1545,1530,1514,1499,1484,1469,1455,1440,1425,1410,1396,1381,1367,1353,1338,1324,1310,1296,1282,1268,1254,1241,1227,1213,1200,1186,1173,1160,1147,1133,1120,1107,1094,1082,1069,1056,1044,1031,1018,1006,994,982,969,957,945,933,921,910,898,886,875,863,852,840,829,818,807,796,785,774,763,752,742,731,720,710,700,689,679,669,659,649,639,629,619,610,600,591,581,572,562,553,544,535,526,517,508,499,491,482,473,465,456,448,440,432,424,416,408,400,392,384,377,369,362,354,347,340,332,325,318,311,304,298,291,284,278,271,265,258,252,246,240,234,228,222,216,210,205,199,194,188,183,178,172,167,162,157,152,148,143,138,134,129,125,120,116,112,108,104,100,96,92,88,85,81,78,74,71,67,64,61,58,55,52,49,47,44,41,39,37,34,32,30,28,26,24,22,20,18,17,15,13,12,11,9,8,7,6,5,4,3,3,2,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,3,4,5,6,7,8,9,11,12,13,15,17,18,20,22,24,26,28,30,32,34,37,39,41,44,47,49,52,55,58,61,64,67,71,74,78,81,85,88,92,96,100,104,108,112,116,120,125,129,134,138,143,148,152,157,162,167,172,178,183,188,194,199,205,210,216,222,228,234,240,246,252,258,265,271,278,284,291,298,304,311,318,325,332,340,347,354,362,369,377,384,392,400,408,416,424,432,440,448,456,465,473,482,491,499,508,517,526,535,544,553,562,572,581,591,600,610,619,629,639,649,659,669,679,689,700,710,720,731,742,752,763,774,785,796,807,818,829,840,852,863,875,886,898,910,921,933,945,957,969,982,994,1006,1018,1031,1044,1056,1069,1082,1094,1107,1120,1133,1147,1160,1173,1186,1200,1213,1227,1241,1254,1268,1282,1296,1310,1324,1338,1353,1367,1381,1396,1410,1425,1440,1455,1469,1484,1499,1514,1530,1545,1560,1575,1591,1606,1622,1638,1653,1669,1685,1701,1717,1733,1749,1766,1782,1798,1815,1831,1848,1865,1881,1898,1915,1932,1949,1966,1983,2001,2018,2035,2053,2070,2088,2106,2123,2141,2159,2177,2195,2213,2232,2250,2268,2287,2305,2324,2342,2361,2380,2399,2417,2436,2455,2475,2494,2513,2532,2552,2571,2591,2611,2630,2650,2670,2690,2710,2730,2750,2770,2790,2811,2831,2852,2872,2893,2913,2934,2955,2976,2997,3018,3039,3060,3081,3103,3124,3146,3167,3189,3210,3232,3254,3276,3298,3320,3342,3364,3386,3408,3431,3453,3476,3498,3521,3544,3566,3589,3612,3635,3658,3681,3705,3728,3751,3774,3798,3821,3845,3869,3892,3916,3940,3964,3988,4012,4036,4060,4085,4109,4133,4158,4182,4207,4232,4256,4281,4306,4331,4356,4381,4406,4432,4457,4482,4508,4533,4559,4584,4610,4636,4661,4687,4713,4739,4765,4791,4818,4844,4870,4897,4923,4950,4976,5003,5030,5056,5083,5110,5137,5164,5191,5219,5246,5273,5301,5328,5356,5383,5411,5438,5466,5494,5522,5550,5578,5606,5634,5662,5691,5719,5747,5776,5804,5833,5862,5890,5919,5948,5977,6006,6035,6064,6093,6122,6152,6181,6210,6240,6269,6299,6329,6358,6388,6418,6448,6478,6508,6538,6568,6598,6629,6659,6690,6720,6751,6781,6812,6842,6873,6904,6935,6966,6997,7028,7059,7090,7122,7153,7184,7216,7247,7279,7310,7342,7374,7406,7437,7469,7501,7533,7566,7598,7630,7662,7694,7727,7759,7792,7824,7857,7890,7922,7955,7988,8021,8054,8087,8120,8153,8187,8220,8253,8287,8320,8353,8387,8421,8454,8488,8522,8556,8590,8623,8658,8692,8726,8760,8794,8828,8863,8897,8932,8966,9001,9035,9070,9105,9140,9174,9209,9244,9279,9314,9350,9385,9420,9455,9491,9526,9562,9597,9633,9668,9704,9740,9775,9811,9847,9883,9919,9955,9991,10027,10064,10100,10136,10173,10209,10246,10282,10319,10355,10392,10429,10466,10502,10539,10576,10613,10650,10687,10725,10762,10799,10836,10874,10911,10949,10986,11024,11061,11099,11137,11175,11212,11250,11288,11326,11364,11402,11441,11479,11517,11555,11594,11632,11670,11709,11747,11786,11825,11863,11902,11941,11980,12019,12058,12096,12136,12175,12214,12253,12292,12331,12371,12410,12449,12489,12528,12568,12608,12647,12687,12727,12766,12806,12846,12886,12926,12966,13006,13046,13086,13127,13167,13207,13248,13288,13328,13369,13409,13450,13491,13531,13572,13613,13654,13694,13735,13776,13817,13858,13899,13941,13982,14023,14064,14105,14147,14188,14230,14271,14313,14354,14396,14437,14479,14521,14563,14604,14646,14688,14730,14772,14814,14856,14898,14940,14983,15025,15067,15109,15152,15194,15237,15279,15322,15364,15407,15450,15492,15535,15578,15621,15663,15706,15749,15792,15835,15878,15921,15965,16008,16051,16094,16137,16181,16224,16268,16311,16354,16398,16442,16485,16529,16572,16616,16660,16704,16748,16791,16835,16879,16923,16967,17011,17055,17100,17144,17188,17232,17276,17321,17365,17410,17454,17498,17543,17587,17632,17677,17721,17766,17811,17855,17900,17945,17990,18035,18080,18125,18169,18215,18260,18305,18350,18395,18440,18485,18531,18576,18621,18667,18712,18757,18803,18848,18894,18939,18985,19031,19076,19122,19168,19213,19259,19305,19351,19397,19443,19489,19535,19581,19627,19673,19719,19765,19811,19857,19903,19950,19996,20042,20089,20135,20181,20228,20274,20321,20367,20414,20460,20507,20554,20600,20647,20694,20740,20787,20834,20881,20928,20974,21021,21068,21115,21162,21209,21256,21303,21351,21398,21445,21492,21539,21586,21634,21681,21728,21776,21823,21870,21918,21965,22013,22060,22108,22155,22203,22250,22298,22346,22393,22441,22489,22537,22584,22632,22680,22728,22776,22823,22871,22919,22967,23015,23063,23111,23159,23207,23255,23304,23352,23400,23448,23496,23544,23593,23641,23689,23738,23786,23834,23883,23931,23979,24028,24076,24125,24173,24222,24270,24319,24367,24416,24465,24513,24562,24611,24659,24708,24757,24806,24854,24903,24952,25001,25050,25098,25147,25196,25245,25294,25343,25392,25441,25490,25539,25588,25637,25686,25735,25784,25833,25883,25932,25981,26030,26079,26128,26178,26227,26276,26325,26375,26424,26473,26523,26572,26621,26671,26720,26770,26819,26869,26918,26967,27017,27066,27116,27165,27215,27264,27314,27364,27413,27463,27512,27562,27612,27661,27711,27761,27810,27860,27910,27959,28009,28059,28109,28158,28208,28258,28308,28358,28407,28457,28507,28557,28607,28657,28706,28756,28806,28856,28906,28956,29006,29056,29106,29156,29206,29256,29306,29356,29406,29456,29506,29556,29606,29656,29706,29756,29806,29856,29906,29956,30006,30056,30106,30156,30207,30257,30307,30357,30407,30457,30507,30557,30608,30658,30708,30758,30808,30858,30909,30959,31009,31059,31109,31160,31210,31260,31310,31360,31411,31461,31511,31561,31612,31662,31712,31762,31813,31863,31913,31963,32014,32064,32114,32164,32215,32265,32315,32365,32416,32466,32516,32566,32617,32667,32717 };


#include <analogShield.h>
#include <avr/pgmspace.h>
#include <TimerOne.h>

#define STEPS 1000 //100
#define LENGTH 5

//scratch variables
char recievedMessage[128];

volatile unsigned int frequencyIncrement = 1000; //32 bits
volatile unsigned int frequencyIncrement2 = 4010; //32 bits
volatile unsigned int phaseAccumulator = 0; //32 bits
volatile unsigned int phaseAccumulator2 = 0; //32 bits
volatile unsigned long counter = 0;
#define INTERRUPT_PERIOD 30

void setup()
{
    Timer1.initialize(INTERRUPT_PERIOD); //100000
    Timer1.attachInterrupt(circle);
    Serial.begin(115200);
}
int loopCount = 0;
float ff = 6000;
int rf = 1;

int df =2*ff; //delta frequency factor

#define MAG_LEN 50
float magArray[MAG_LEN] = {0};
float minMag(float * array, int length)
{
  float minVal = 200;
  for(int i = 0; i<length; i++)
  {
    if(array[i] < minVal)
      minVal = array[i];
  }
  if(minVal < 7)
    return 7;
  else
    return minVal;
}
float minVal = 0;
void loop()
{
      cli();
      
      int ch1 = analog.signedRead(0);
      int ch2 = analog.signedRead(3);
      
      float mag = log(sqrt(pow(ch1,2) + pow(ch2,2)));
      magArray[loopCount] = mag;
      loopCount++;
      //sei();
      minVal = minMag(magArray, MAG_LEN);
      int logMag = constrain(map(mag, minVal,minVal+20, 0,df), 0, df);
      //cli();
      //Serial.println(minVal);
      frequencyIncrement = ff + logMag;
      frequencyIncrement2 = ff;
      
      //frequencyIncrement = round(1500*log(map((analog.signedRead(0)),30000, 60000, ff*rf-df, ff*rf+df)/5) * 5);
      //frequencyIncrement2 = round(1500*log(map((analog.signedRead(3)),30000, 60000, ff-df, ff+df)/5) * 5);
      if(loopCount >= MAG_LEN)
      {
        loopCount = 0;
      }
      sei();
      delay(5);
      
}

void circle() //this is it.
{
    counter++;
    //increment the phase accumulator
    phaseAccumulator += frequencyIncrement;
    phaseAccumulator2 += frequencyIncrement2;
    
    //peel off top 12 bits
    unsigned int tempPhase =  (phaseAccumulator >> 4);
    unsigned int tempPhase2 =  ((phaseAccumulator2 >> 4) + 1023) & 0x0FFF;

    //unsigned long table_offset = ;
    unsigned int value = pgm_read_word(isinTable16 + tempPhase);
    unsigned int value2 = pgm_read_word(isinTable16 + tempPhase2);
    analog.write(value,value2, true);
}
